{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Doctor Dashboard | VMS</title>

<style>
:root{
  --glass-bg: rgba(255,255,255,.72);
  --glass-shadow: 0 18px 40px rgba(0,0,0,.18);
  --primary:#0b5cff;
}

/* ===== BASE ===== */
*{box-sizing:border-box}
html,body{height:100%;margin:0}

body{
  font-family:"Segoe UI",Tahoma,Verdana,sans-serif;
  background-image:url("https://i.pinimg.com/736x/f8/ad/d5/f8add51acaad02b06db9c2c8b1483898.jpg");
  background-size:cover;
  background-position:center;
  color:#111;
}

.layout{display:flex;height:100vh;padding:24px;gap:20px}

/* ===== SIDEBAR ===== */
.sidebar{
  width:260px;
  background:var(--glass-bg);
  backdrop-filter:blur(14px);
  box-shadow:var(--glass-shadow);
  border-radius:20px;
  padding:24px 18px;
}

.sidebar h2{text-align:center;margin-bottom:22px}

.nav a{
  display:flex;
  align-items:center;
  gap:10px;
  padding:12px 16px;
  border-radius:12px;
  margin-bottom:8px;
  font-weight:600;
  text-decoration:none;
  color:#111;
}

.nav a:hover,.nav a.active{
  background:rgba(0,0,0,.85);
  color:#fff;
}

/* ===== MAIN ===== */
.main{flex:1;display:flex;flex-direction:column;gap:20px}

/* ===== TOPBAR ===== */
.topbar{
  background:var(--glass-bg);
  backdrop-filter:blur(14px);
  box-shadow:var(--glass-shadow);
  border-radius:18px;
  padding:16px 22px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  position:relative;
  z-index:1000;
}

/* ===== PROFILE ===== */
.profile{position:relative}

.profile-btn{
  display:flex;
  align-items:center;
  gap:8px;
  padding:8px 14px;
  border-radius:999px;
  background:rgba(255,255,255,.55);
  border:1px solid rgba(0,0,0,.15);
  font-weight:700;
  cursor:pointer;
}

.profile-btn:hover{
  background:rgba(0,0,0,.85);
  color:#fff;
}

.profile-menu{
  position:absolute;
  right:0;
  top:54px;
  width:260px;
  background:var(--glass-bg);
  backdrop-filter:blur(14px);
  box-shadow:var(--glass-shadow);
  border-radius:16px;
  padding:14px;
  display:none;
  z-index:9999;
}

.profile-menu.show{display:block}

.profile-menu p{
  margin:0 0 10px;
  font-size:14px;
}

.logout-btn{
  width:100%;
  border:none;
  background:#e53935;
  color:#fff;
  padding:10px;
  border-radius:10px;
  font-weight:700;
  cursor:pointer;
}

.logout-btn:hover{background:#c62828}

/* ===== CONTENT ===== */
.content{
  flex:1;
  background:var(--glass-bg);
  backdrop-filter:blur(14px);
  box-shadow:var(--glass-shadow);
  border-radius:22px;
  padding:28px;
  overflow:auto;
}

/* ===== STATS ===== */
.stats-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(280px,1fr));
  gap:22px;
}

.stat-box{
  background:rgba(255,255,255,.65);
  border-radius:22px;
  padding:24px;
  box-shadow:0 18px 35px rgba(0,0,0,.18);
  text-align:center;
}

/* ===== HEART CIRCLE ===== */
.circle{
  width:120px;
  height:120px;
  border-radius:50%;
  margin:14px auto;
  display:flex;
  align-items:center;
  justify-content:center;
  position:relative;
  background:#fff;
  animation: beat var(--beat-speed) infinite ease-in-out;
}

.circle span{
  font-size:22px;
  font-weight:800;
}

.circle::before{
  content:"";
  position:absolute;
  inset:-10px;
  border-radius:50%;
  border:3px solid rgba(255, 11, 11, 0.6);
  animation:pulse var(--beat-speed) infinite;
  filter: drop-shadow(0 0 6px rgba(229,57,53,.8));
}

@keyframes beat{
  0%{transform:scale(1)}
  30%{transform:scale(1.08)}
  60%{transform:scale(.96)}
  100%{transform:scale(1)}
}

@keyframes pulse{
  0%{opacity:.8;transform:scale(.9)}
  70%{opacity:0;transform:scale(1.25)}
  100%{opacity:0}
}

/* ===== ECG WAVE (UNCHANGED) ===== */
.wave{margin-top:10px;height:36px;overflow:hidden}
.wave svg{width:200%;height:36px}
.ecg{
  fill:none;
  stroke:#e53935;
  stroke-width:3;
  stroke-dasharray:240;
  animation:ecgMove var(--beat-speed) linear infinite;
  filter: drop-shadow(0 0 6px rgba(229,57,53,.8));
}
@keyframes ecgMove{
  from{stroke-dashoffset:0}
  to{stroke-dashoffset:-240}
}
</style>
</head>

<body>
<div class="layout">

<!-- SIDEBAR -->
<aside class="sidebar">
  <h2>VMS Doctor Panelü©∫</h2>
  <nav class="nav">
    <a class="active" href="/doctor/">Dashboard</a>
    <a href="/overview/">Overview</a>
    <a href="/allergies/">Allergies</a>
    <a href="/visits/">Visits</a>
    <a href="/vitals/">Vitals</a>
    <a href="/medical-notes/">Medical Notes</a>
    <a href="/medications/">Medications</a>
    <a href="/documents/">Documents</a>
    <a href="/treatments/">Treatments</a>
  </nav>
</aside>

<!-- MAIN -->
<main class="main">

<div class="topbar">
  <h1>Veterinary Management System üêæ</h1>

  <div class="profile">
    <div class="profile-btn" id="profileBtn">
       Dr. {{ request.user.username }} ‚ñº
    </div>

    <div class="profile-menu" id="profileMenu">
      <p><strong>{{ request.user.get_full_name|default:request.user.username }}</strong></p>
      <p>Email: {{ request.user.email }}</p>

      <form method="post" action="{% url 'logout' %}">
        {% csrf_token %}
        <button class="logout-btn"> Logout</button>
      </form>
    </div>
  </div>
</div>

<section class="content">

<div class="stats-grid">

<div class="stat-box" data-value="{{ patients_count }}" data-max="200">
  <div>üê∂ Patients</div>
  <div class="circle"><span>0</span></div>
  <div class="wave">
    <svg viewBox="0 0 300 40">
      <path class="ecg" d="M0 20 L30 20 L40 10 L50 30 L60 20 L90 20 L100 10 L110 30 L120 20 L300 20"/>
    </svg>
  </div>
</div>

<div class="stat-box" data-value="{{ visits_count }}" data-max="150">
  <div>üìÖ Visits</div>
  <div class="circle"><span>0</span></div>
  <div class="wave">
    <svg viewBox="0 0 300 40">
      <path class="ecg" d="M0 20 L30 20 L40 8 L50 32 L60 20 L90 20 L100 8 L110 32 L120 20 L300 20"/>
    </svg>
  </div>
</div>

<div class="stat-box" data-value="{{ treatments_count }}" data-max="150">
  <div>üíâ Treatments</div>
  <div class="circle"><span>0</span></div>
  <div class="wave">
    <svg viewBox="0 0 300 40">
      <path class="ecg" d="M0 20 L30 20 L40 12 L50 28 L60 20 L90 20 L100 12 L110 28 L120 20 L300 20"/>
    </svg>
  </div>
</div>

</div>
</section>
</main>
</div>

<script>
/* PROFILE DROPDOWN */
const btn=document.getElementById("profileBtn");
const menu=document.getElementById("profileMenu");
btn.onclick=e=>{e.stopPropagation();menu.classList.toggle("show")};
document.onclick=()=>menu.classList.remove("show");

/* HEART COUNTERS */
document.querySelectorAll(".stat-box").forEach(box=>{
  const val=parseInt(box.dataset.value||0);
  const max=parseInt(box.dataset.max||100);
  const bpm=Math.min(160,Math.max(50,(val/max)*120));
  box.style.setProperty("--beat-speed",(60/bpm)+"s");

  const span=box.querySelector("span");
  let c=0,step=Math.max(1,Math.floor(val/25));
  const t=setInterval(()=>{
    c+=step;if(c>=val){c=val;clearInterval(t)}
    span.textContent=c;
  },40);
});
</script>

</body>
</html>
